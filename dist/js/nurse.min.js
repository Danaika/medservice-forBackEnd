"use strict";function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tableWrapper=document.querySelector(".table_wrapper");if(tableWrapper){var oldScrollTop=0,oldScrollLeft=0,instance=OverlayScrollbars(tableWrapper,{scrollbars:{autoHide:"leave",autoHideDelay:500}}),$table=$("#nurse_table");$table.floatThead({zIndex:10,scrollContainer:function(e){return e.closest(".table_container")}}),$("table").floatThead("reflow")}!function(){var e=document.getElementById("calendar_input"),a=["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"];if(e){var n=datepicker("#calendar_input",{onSelect:function(){},onShow:function(){setTimeout(function(){e.scrollIntoView(!0)},0)},formatter:function(e,t){new Date;var n=t.getDate(),r=t.getMonth(),o=t.getFullYear();console.log("month_list[mm]="+a[r]),console.log("mm = "+r),e.value=n+" "+a[r]+" "+o},startDay:1,customDays:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],customMonths:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],customOverlayMonths:["Янв","Фев","Март","Апр","Май","Июнь","Июль","Авг","Сен","Окт","Нояб","Дек"],showAllDates:!0,overlayButton:"Готово",overlayPlaceholder:"Введите год"});document.getElementById("calendar_btn").addEventListener("click",function(e){e.stopPropagation();var t=n.calendarContainer.classList.contains("qs-hidden");n[t?"show":"hide"]()});var t=document.querySelectorAll(".schedule__month .btn-arrow--dark"),r=document.querySelector(".schedule__month .btn-lr__name .btn-lr-m"),o=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],c=(new Date).getMonth();r.innerHTML=o[c],t.forEach(function(t){t.addEventListener("click",function(e){c=t.classList.contains("left")?0===c?11:c-1:11===c?0:c+1,r.innerHTML=o[c]})})}}(),function(){var e=navigator.userAgent.toLowerCase(),t=-1<e.indexOf("iphone")||-1<e.indexOf("ipad"),n=-1<e.indexOf("safari")&&-1===e.indexOf("win")&&(-1===e.indexOf("mobile")||t),r=window.innerHeight,o=window.innerWidth,a=document.querySelector(".container"),c=i(a,"padding-top"),l=i(a,"padding-bottom");function i(e,t){return getComputedStyle(e)[t]}n&&1023<o&&o<1347&&(a.style.height="".concat(r-parseInt(c)-parseInt(l),"px")),n||(document.body.style.height="100vh");var s=document.querySelector(".table_wrapper");if(s){var d=document.querySelector(".table_container"),u=document.querySelector(".content-title"),p=document.querySelector(".content-block"),m=document.querySelector(".header-block"),f=document.querySelector(".nurse-main"),y=document.querySelector(".nurse-page"),b=u.clientHeight,v=i(u,"margin-bottom"),g=i(p,"padding-top"),h=i(p,"padding-bottom"),w=m.clientHeight,S=i(m,"margin-bottom"),L=i(f,"padding-top"),O=i(f,"padding-bottom"),_=i(y,"padding-top"),I=i(y,"padding-bottom"),q=parseInt(r)-parseInt(_)-parseInt(I)-parseInt(L)-parseInt(O)-parseInt(S)-parseInt(w)-parseInt(h)-parseInt(g)-parseInt(v)-parseInt(b);n&&(q+=parseInt(S),1023<o&&o<1347||(q=q-parseInt(c)-parseInt(l)+parseInt(S))),s.style.height="".concat(q,"px"),d.style.height="".concat(q,"px"),s.style.maxHeight="".concat(q,"px")}}(),function(){var e=document.getElementById("modal-template");if(e){var a=e.innerHTML,c=document.getElementById("researchTable").innerHTML,l=document.getElementById("medicinesTable").innerHTML;document.querySelectorAll(".nurse-main .btn--table").forEach(function(o){o.addEventListener("click",function(e){var t=c,n="#research_table";o.classList.contains("btn--purple")&&(t=l,n="#medicines_table"),window.scrollTo(0,0);var r=function(e){var t=document.createElement("div");t.className="popup",t.innerHTML=a;var n=t.querySelector(".overlay");return n.classList.add("dialog--flex-display"),t.querySelector(".popup__container").innerHTML=e,n.addEventListener("click",function(e){e.target===n&&document.body.removeChild(t)}),{container:t,open:function(){document.body.appendChild(t)},close:function(){document.body.removeChild(t)}}}(t);r.open(),function(e,t){if(e){OverlayScrollbars(e,{scrollbars:{autoHide:"leave",autoHideDelay:500}});$(t).floatThead({scrollContainer:function(e){return console.log(e),e.closest(".table-responsive")}}),$("table").floatThead("reflow")}}(r.container.querySelector(".table_wrapper"),n)})})}}(),function(){if(document.querySelector(".datetime")){var e=new CalendarClock(".datetime");setInterval(function(){return e.update()},1e3)}function r(e){if(e.classList.contains("active"))e.classList.remove("active");else{var t=e.parentNode.querySelector(".active");t&&t.classList.remove("active"),e.classList.add("active")}}if(document.querySelectorAll(".layer").forEach(function(n){n.addEventListener("click",function(e){var t=e.target.parentNode;(t.classList.contains("layer__top")||t.classList.contains("layer"))&&r(n)})}),document.querySelectorAll(".schedule-list__item").forEach(function(t){t.addEventListener("click",function(e){console.log(e.target.parentNode);e.target.parentNode;r(t)})}),0!==document.querySelectorAll(".scrolled").length)OverlayScrollbars(document.querySelectorAll(".scrolled"),{scrollbars:{autoHide:"scroll",autoHideDelay:1e3}})}(),function(){var e=document.querySelector("#popup-template");if(e){e.innerHTML;window.addEventListener("DOMContentLoaded",function(e){setTimeout(function(){},500)})}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkYXB0aXZlLmpzIiwiY2FsZW5kYXIuanMiLCJjc3MuanMiLCJkaWFsb2dzLmpzIiwiZXZlbnRzLmpzIiwicG9wdXAuanMiXSwibmFtZXMiOlsidGFibGVXcmFwcGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwib2xkU2Nyb2xsVG9wIiwib2xkU2Nyb2xsTGVmdCIsImluc3RhbmNlIiwiT3ZlcmxheVNjcm9sbGJhcnMiLCJzY3JvbGxiYXJzIiwiYXV0b0hpZGUiLCJhdXRvSGlkZURlbGF5IiwiJHRhYmxlIiwiJCIsImZsb2F0VGhlYWQiLCJ6SW5kZXgiLCJzY3JvbGxDb250YWluZXIiLCJjbG9zZXN0IiwiZWxlbSIsImdldEVsZW1lbnRCeUlkIiwibW9udGhfbGlzdCIsInBpY2tlciIsImRhdGVwaWNrZXIiLCJvblNlbGVjdCIsIm9uU2hvdyIsInNldFRpbWVvdXQiLCJzY3JvbGxJbnRvVmlldyIsImZvcm1hdHRlciIsImlucHV0IiwiZGF0ZSIsIkRhdGUiLCJkZCIsImdldERhdGUiLCJtbSIsImdldE1vbnRoIiwieXl5eSIsImdldEZ1bGxZZWFyIiwiY29uc29sZSIsImxvZyIsInZhbHVlIiwic3RhcnREYXkiLCJjdXN0b21EYXlzIiwiY3VzdG9tTW9udGhzIiwiY3VzdG9tT3ZlcmxheU1vbnRocyIsInNob3dBbGxEYXRlcyIsIm92ZXJsYXlCdXR0b24iLCJvdmVybGF5UGxhY2Vob2xkZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInN0b3BQcm9wYWdhdGlvbiIsImlzSGlkZGVuIiwiY2FsZW5kYXJDb250YWluZXIiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImJ0bnNBcnJvdyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJtb250aE5hbWVTcGFuIiwiX21vbnRoIiwibW9udGhJbmRleCIsImlubmVySFRNTCIsImZvckVhY2giLCJidG4iLCJjdXJyZW50VXNlckFnZW50IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwidG9Mb3dlckNhc2UiLCJpc0lwaG9uZSIsImluZGV4T2YiLCJpc1NhZmFyaSIsIndpbm93SGVpZ2h0Iiwid2luZG93IiwiaW5uZXJIZWlnaHQiLCJ3aW5vd1dpZHRoIiwiaW5uZXJXaWR0aCIsImNvbnRhaW5lciIsImNvbnRhaW5lcl9wdCIsImdldFN0eWxlIiwiY29udGFpbmVyX3BiIiwicHJvcGVydHlOYW1lIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInN0eWxlIiwiaGVpZ2h0IiwiY29uY2F0IiwicGFyc2VJbnQiLCJib2R5IiwidGFibGVfd3JhcHBlciIsInRhYmxlX2NvbnRhaW5lciIsImNvbnRlbnRfdGl0bGUiLCJjb250ZW50X2Jsb2NrIiwiaGVhZGVyX2Jsb2NrIiwibnVyc2VfbWFpbiIsIm51cnNlX3BhZ2UiLCJjb250ZW50X3RpdGxlX2giLCJjbGllbnRIZWlnaHQiLCJjb250ZW50X3RpdGxlX21iIiwiY29udGVudF9ibG9ja19wdCIsImNvbnRlbnRfYmxvY2tfcGIiLCJoZWFkZXJfYmxvY2tfaCIsImhlYWRlcl9ibG9ja19tYiIsIm51cnNlX21haW5fcHQiLCJudXJzZV9tYWluX3BiIiwibnVyc2VfcGFnZV9wdCIsIm51cnNlX3BhZ2VfcGIiLCJ0YWJsZUhlaWd0aCIsIm1heEhlaWdodCIsImRpYWxvZ1RlbXBsRWxlbSIsIm1vZGFsVGVtcGxhdGUiLCJyZXNlYXJjaFRlbXBsYXRlIiwibWVkaWNpbmVzVGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsImlkIiwic2Nyb2xsVG8iLCJkaWFsb2ciLCJkaWFsb2dUZW1wYXRlIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsIm92ZXJsYXkiLCJhZGQiLCJ0YXJnZXQiLCJyZW1vdmVDaGlsZCIsIm9wZW4iLCJhcHBlbmRDaGlsZCIsImNsb3NlIiwiY3JlYXRlRGlhbG9nIiwiYWN0aXZhdGVUYWJsZVNjcm9sbCIsImNhbGVuZGFyIiwiQ2FsZW5kYXJDbG9jayIsInNldEludGVydmFsIiwidXBkYXRlIiwic2V0QWN0aXZlIiwiaXRlbSIsInJlbW92ZSIsImFjdGl2ZUl0ZW0iLCJwYXJlbnROb2RlIiwibGF5ZXIiLCJ0YXJnZXRQYXJlbnQiLCJzY2hlZHVsZV9saXN0X19pdGVtX2kiLCJsZW5ndGgiLCJwb3B1cFRlbWxFbGVtIl0sIm1hcHBpbmdzIjoid3ZCQUNBLElBQUFBLGFBQUFDLFNBQUFDLGNBQUEsa0JBQ0EsR0FBQUYsYUFBQSxDQUNBLElBQUFHLGFBQUEsRUFDQUMsY0FBQSxFQUNBQyxTQUFBQyxrQkFBQU4sYUFBQSxDQUNBTyxXQUFBLENBQ0FDLFNBQUEsUUFDQUMsY0FBQSxPQUdBQyxPQUFBQyxFQUFBLGdCQUVBRCxPQUFBRSxXQUFBLENBQ0FDLE9BQUEsR0FDQUMsZ0JBQUEsU0FBQUosR0FDQSxPQUFBQSxFQUFBSyxRQUFBLHVCQUdBSixFQUFBLFNBQUFDLFdBQUEsV0NuQkEsV0FDQSxJQUFBSSxFQUFBZixTQUFBZ0IsZUFBQSxrQkFDQUMsRUFBQSxDQUFBLFNBQUEsVUFBQSxRQUFBLFNBQUEsTUFBQSxPQUFBLE9BQUEsVUFBQSxXQUFBLFVBQUEsU0FBQSxXQUNBLEdBQUFGLEVBQUEsQ0FDQSxJQUFBRyxFQUFBQyxXQUFBLGtCQUFBLENBQ0FDLFNBQUEsYUFHQUMsT0FBQSxXQUNBQyxXQUFBLFdBQ0FQLEVBQUFRLGdCQUFBLElBQ0EsSUFFQUMsVUFBQSxTQUFBQyxFQUFBQyxHQUVBLElBQUFDLEtBQUEsSUFDQUMsRUFBQUYsRUFBQUcsVUFDQUMsRUFBQUosRUFBQUssV0FDQUMsRUFBQU4sRUFBQU8sY0FDQUMsUUFBQUMsSUFBQSxrQkFBQWxCLEVBQUFhLElBQ0FJLFFBQUFDLElBQUEsUUFBQUwsR0FDQUwsRUFBQVcsTUFBQVIsRUFBQSxJQUFBWCxFQUFBYSxHQUFBLElBQUFFLEdBRUFLLFNBQUEsRUFDQUMsV0FBQSxDQUFBLEtBQUEsS0FBQSxLQUFBLEtBQUEsS0FBQSxLQUFBLE1BQ0FDLGFBQUEsQ0FBQSxTQUFBLFVBQUEsT0FBQSxTQUFBLE1BQUEsT0FBQSxPQUFBLFNBQUEsV0FBQSxVQUFBLFNBQUEsV0FDQUMsb0JBQUEsQ0FBQSxNQUFBLE1BQUEsT0FBQSxNQUFBLE1BQUEs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IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YWJsZV93cmFwcGVyJyk7XG5pZiAodGFibGVXcmFwcGVyKSB7XG4gICAgdmFyIG9sZFNjcm9sbFRvcCA9IDA7XG4gICAgdmFyIG9sZFNjcm9sbExlZnQgPSAwO1xuICAgIHZhciBpbnN0YW5jZSA9IE92ZXJsYXlTY3JvbGxiYXJzKHRhYmxlV3JhcHBlciwge1xuICAgICAgICBzY3JvbGxiYXJzOiB7XG4gICAgICAgICAgICBhdXRvSGlkZTogJ2xlYXZlJyxcbiAgICAgICAgICAgIGF1dG9IaWRlRGVsYXk6IDUwMFxuICAgICAgICB9XG4gICAgfSk7XG4gICAgdmFyICR0YWJsZSA9ICQoJyNudXJzZV90YWJsZScpO1xuXG4gICAgJHRhYmxlLmZsb2F0VGhlYWQoe1xuICAgICAgICB6SW5kZXg6IDEwLFxuICAgICAgICBzY3JvbGxDb250YWluZXI6IGZ1bmN0aW9uKCR0YWJsZSl7XG4gICAgICAgICAgICByZXR1cm4gJHRhYmxlLmNsb3Nlc3QoJy50YWJsZV9jb250YWluZXInKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgICQoJ3RhYmxlJykuZmxvYXRUaGVhZCgncmVmbG93Jyk7XG59IiwiOyhmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYWxlbmRhcl9pbnB1dCcpO1xuICAgIGNvbnN0IG1vbnRoX2xpc3QgPSBbJ9Cv0L3QstCw0YDRjycsICfQpNC10LLRgNCw0LvRjycsICfQnNCw0YDRgtCwJywgJ9CQ0L/RgNC10LvRjycsICfQnNCw0Y8nLCAn0JjRjtC90Y8nLCAn0JjRjtC70Y8nLCAn0JDQstCz0YPRgdGC0LAnLCAn0KHQtdC90YLRj9Cx0YDRjycsICfQntC60YLRj9Cx0YDRjycsICfQndC+0Y/QsdGA0Y8nLCAn0JTQtdC60LDQsdGA0Y8nXTtcbiAgICBpZiAoIWVsZW0pIHJldHVybjtcbiAgICBjb25zdCBwaWNrZXIgPSBkYXRlcGlja2VyKCcjY2FsZW5kYXJfaW5wdXQnLCB7XG4gICAgICAgIG9uU2VsZWN0OiAoaW5zdGFuY2UsIGRhdGUpID0+IHtcblxuICAgICAgICB9LFxuICAgICAgICBvblNob3c6IGluc3RhbmNlID0+IHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVsZW0uc2Nyb2xsSW50b1ZpZXcodHJ1ZSk7XG4gICAgICAgICAgICB9LCAwKVxuICAgICAgICB9LFxuICAgICAgICBmb3JtYXR0ZXI6IChpbnB1dCwgZGF0ZSwgaW5zdGFuY2UpID0+IHtcbiAgICAgICAgICAgIC8vINC80LXQvdGP0LXRgiDRhNC+0YDQvNCw0YIg0LTQsNGC0Ysg0L3QsCDQtNC0LtC80Lwu0LPQs9Cz0LNcbiAgICAgICAgICAgIGxldCBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIGxldCBkZCA9IGRhdGUuZ2V0RGF0ZSgpO1xuICAgICAgICAgICAgbGV0IG1tID0gZGF0ZS5nZXRNb250aCgpOy8vPDk/JzAnKyhkYXRlLmdldE1vbnRoKCkgKyAxKTpkYXRlLmdldE1vbnRoKCkgKyAxICA7IC8vTW9udGhzIGFyZSB6ZXJvIGJhc2VkXG4gICAgICAgICAgICBsZXQgeXl5eSA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibW9udGhfbGlzdFttbV09XCIgKyBtb250aF9saXN0W21tXSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1tID0gXCIgKyBtbSk7XG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IGRkICsgJyAnICsgbW9udGhfbGlzdFttbV0gKyAnICcgKyB5eXl5XG4gICAgICAgIH0sXG4gICAgICAgIHN0YXJ0RGF5OiAxLFxuICAgICAgICBjdXN0b21EYXlzOiBbJ9CS0YEnLCAn0J/QvScsICfQktGCJywgJ9Ch0YAnLCAn0KfRgicsICfQn9GCJywgJ9Ch0LEnXSxcbiAgICAgICAgY3VzdG9tTW9udGhzOiBbJ9Cv0L3QstCw0YDRjCcsICfQpNC10LLRgNCw0LvRjCcsICfQnNCw0YDRgicsICfQkNC/0YDQtdC70YwnLCAn0JzQsNC5JywgJ9CY0Y7QvdGMJywgJ9CY0Y7Qu9GMJywgJ9CQ0LLQs9GD0YHRgicsICfQodC10L3RgtGP0LHRgNGMJywgJ9Ce0LrRgtGP0LHRgNGMJywgJ9Cd0L7Rj9Cx0YDRjCcsICfQlNC10LrQsNCx0YDRjCddLFxuICAgICAgICBjdXN0b21PdmVybGF5TW9udGhzOiBbJ9Cv0L3QsicsICfQpNC10LInLCAn0JzQsNGA0YInLCAn0JDQv9GAJywgJ9Cc0LDQuScsICfQmNGO0L3RjCcsICfQmNGO0LvRjCcsICfQkNCy0LMnLCAn0KHQtdC9JywgJ9Ce0LrRgicsICfQndC+0Y/QsScsICfQlNC10LonXSxcbiAgICAgICAgc2hvd0FsbERhdGVzOiB0cnVlLFxuICAgICAgICBvdmVybGF5QnV0dG9uOiAn0JPQvtGC0L7QstC+JyxcbiAgICAgICAgb3ZlcmxheVBsYWNlaG9sZGVyOiAn0JLQstC10LTQuNGC0LUg0LPQvtC0J1xuICAgIH0pO1xuXG4gICAgbGV0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FsZW5kYXJfYnRuXCIpO1xuXG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGNvbnN0IGlzSGlkZGVuID0gcGlja2VyLmNhbGVuZGFyQ29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygncXMtaGlkZGVuJyk7XG4gICAgICAgIHBpY2tlcltpc0hpZGRlbiA/ICdzaG93JyA6ICdoaWRlJ10oKVxuICAgIH0pO1xuXG4gICAgY29uc3QgYnRuc0Fycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNjaGVkdWxlX19tb250aCAuYnRuLWFycm93LS1kYXJrJyk7XG4gICAgY29uc3QgbW9udGhOYW1lU3BhbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY2hlZHVsZV9fbW9udGggLmJ0bi1scl9fbmFtZSAuYnRuLWxyLW0nKTtcbiAgICBjb25zdCBfbW9udGggPSBbJ9Cv0L3QstCw0YDRjCcsICfQpNC10LLRgNCw0LvRjCcsICfQnNCw0YDRgicsICfQkNC/0YDQtdC70YwnLCAn0JzQsNC5JywgJ9CY0Y7QvdGMJywgJ9CY0Y7Qu9GMJywgJ9CQ0LLQs9GD0YHRgicsICfQodC10L3RgtGP0LHRgNGMJywgJ9Ce0LrRgtGP0LHRgNGMJywgJ9Cd0L7Rj9Cx0YDRjCcsICfQlNC10LrQsNCx0YDRjCddO1xuICAgIGxldCBtb250aEluZGV4ID0gbmV3IERhdGUoKS5nZXRNb250aCgpO1xuICAgIG1vbnRoTmFtZVNwYW4uaW5uZXJIVE1MID0gX21vbnRoW21vbnRoSW5kZXhdO1xuXG4gICAgYnRuc0Fycm93LmZvckVhY2goYnRuID0+IHtcbiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG4gICAgICAgICAgICBsZXQgaWR4ID0gbW9udGhJbmRleDtcbiAgICAgICAgICAgIGlmIChidG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdsZWZ0JykpIHtcbiAgICAgICAgICAgICAgICBtb250aEluZGV4ID0gbW9udGhJbmRleCA9PT0gMCA/IDExIDogbW9udGhJbmRleCAtIDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1vbnRoSW5kZXggPSBtb250aEluZGV4ID09PSAxMSA/IDAgOiBtb250aEluZGV4ICsgMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbW9udGhOYW1lU3Bhbi5pbm5lckhUTUwgPSBfbW9udGhbbW9udGhJbmRleF07XG4gICAgICAgIH0pO1xuICAgIH0pXG59KSgpO1xuIiwiOyhmdW5jdGlvbiAoKSB7XG5cbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHZhciBjdXJyZW50VXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xuICAgIHZhciBpc0lwaG9uZSA9IGN1cnJlbnRVc2VyQWdlbnQuaW5kZXhPZignaXBob25lJykgPiAtMSB8fCBjdXJyZW50VXNlckFnZW50LmluZGV4T2YoJ2lwYWQnKSA+IC0xO1xuICAgIHZhciBpc1NhZmFyaSA9IChjdXJyZW50VXNlckFnZW50LmluZGV4T2YoJ3NhZmFyaScpID4gLTEgJiYgY3VycmVudFVzZXJBZ2VudC5pbmRleE9mKCd3aW4nKSA9PT0gLTEpICYmIChjdXJyZW50VXNlckFnZW50LmluZGV4T2YoJ21vYmlsZScpID09PSAtMSB8fCBpc0lwaG9uZSk7XG4gICAgdmFyIHdpbm93SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgIHZhciB3aW5vd1dpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGFpbmVyXCIpO1xuXG4gICAgdmFyIGNvbnRhaW5lcl9wdCA9IGdldFN0eWxlKGNvbnRhaW5lciwgJ3BhZGRpbmctdG9wJyk7XG4gICAgdmFyIGNvbnRhaW5lcl9wYiA9IGdldFN0eWxlKGNvbnRhaW5lciwgJ3BhZGRpbmctYm90dG9tJyk7XG5cbiAgICBpZiAoaXNTYWZhcmkpIHtcbiAgICAgICAgaWYod2lub3dXaWR0aCA+IDEwMjMgJiYgd2lub3dXaWR0aCA8IDEzNDcpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHt3aW5vd0hlaWdodCAtIHBhcnNlSW50KGNvbnRhaW5lcl9wdCkgLSBwYXJzZUludChjb250YWluZXJfcGIpfXB4YDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWlzU2FmYXJpKSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuaGVpZ2h0ID0gXCIxMDB2aFwiO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0eWxlKGVsZW0sIHByb3BlcnR5TmFtZSkge1xuICAgICAgICByZXR1cm4gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtKVtwcm9wZXJ0eU5hbWVdO1xuICAgIH1cblxuICAgIHZhciB0YWJsZV93cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YWJsZV93cmFwcGVyXCIpO1xuICAgIGlmICghdGFibGVfd3JhcHBlcikgcmV0dXJuIGZhbHNlO1xuICAgIHZhciB0YWJsZV9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX2NvbnRhaW5lclwiKTtcbiAgICB2YXIgY29udGVudF90aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudC10aXRsZVwiKTtcbiAgICB2YXIgY29udGVudF9ibG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudC1ibG9ja1wiKTtcbiAgICB2YXIgaGVhZGVyX2Jsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXItYmxvY2tcIik7XG4gICAgdmFyIG51cnNlX21haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm51cnNlLW1haW5cIik7XG4gICAgdmFyIG51cnNlX3BhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm51cnNlLXBhZ2VcIik7XG5cbiAgICB2YXIgY29udGVudF90aXRsZV9oID0gY29udGVudF90aXRsZS5jbGllbnRIZWlnaHQ7XG4gICAgdmFyIGNvbnRlbnRfdGl0bGVfbWIgPSBnZXRTdHlsZShjb250ZW50X3RpdGxlLCAnbWFyZ2luLWJvdHRvbScpO1xuXG5cbiAgICB2YXIgY29udGVudF9ibG9ja19wdCA9IGdldFN0eWxlKGNvbnRlbnRfYmxvY2ssICdwYWRkaW5nLXRvcCcpO1xuICAgIHZhciBjb250ZW50X2Jsb2NrX3BiID0gZ2V0U3R5bGUoY29udGVudF9ibG9jaywgJ3BhZGRpbmctYm90dG9tJyk7XG5cbiAgICB2YXIgaGVhZGVyX2Jsb2NrX2ggPSBoZWFkZXJfYmxvY2suY2xpZW50SGVpZ2h0O1xuICAgIHZhciBoZWFkZXJfYmxvY2tfbWIgPSBnZXRTdHlsZShoZWFkZXJfYmxvY2ssICdtYXJnaW4tYm90dG9tJyk7XG5cbiAgICB2YXIgbnVyc2VfbWFpbl9wdCA9IGdldFN0eWxlKG51cnNlX21haW4sICdwYWRkaW5nLXRvcCcpO1xuICAgIHZhciBudXJzZV9tYWluX3BiID0gZ2V0U3R5bGUobnVyc2VfbWFpbiwgJ3BhZGRpbmctYm90dG9tJyk7XG5cbiAgICB2YXIgbnVyc2VfcGFnZV9wdCA9IGdldFN0eWxlKG51cnNlX3BhZ2UsICdwYWRkaW5nLXRvcCcpO1xuICAgIHZhciBudXJzZV9wYWdlX3BiID0gZ2V0U3R5bGUobnVyc2VfcGFnZSwgJ3BhZGRpbmctYm90dG9tJyk7XG5cbiAgICB2YXIgdGFibGVIZWlndGggPVxuICAgICAgICBwYXJzZUludCh3aW5vd0hlaWdodCkgLVxuICAgICAgICBwYXJzZUludChudXJzZV9wYWdlX3B0KSAtXG4gICAgICAgIHBhcnNlSW50KG51cnNlX3BhZ2VfcGIpIC1cbiAgICAgICAgcGFyc2VJbnQobnVyc2VfbWFpbl9wdCkgLVxuICAgICAgICBwYXJzZUludChudXJzZV9tYWluX3BiKSAtXG4gICAgICAgIHBhcnNlSW50KGhlYWRlcl9ibG9ja19tYikgLVxuICAgICAgICBwYXJzZUludChoZWFkZXJfYmxvY2tfaCkgLVxuICAgICAgICBwYXJzZUludChjb250ZW50X2Jsb2NrX3BiKSAtXG4gICAgICAgIHBhcnNlSW50KGNvbnRlbnRfYmxvY2tfcHQpIC1cbiAgICAgICAgcGFyc2VJbnQoY29udGVudF90aXRsZV9tYikgLVxuICAgICAgICBwYXJzZUludChjb250ZW50X3RpdGxlX2gpO1xuXG4gICAgaWYgKGlzU2FmYXJpKSB7XG4gICAgICAgIHRhYmxlSGVpZ3RoID0gdGFibGVIZWlndGggKyBwYXJzZUludChoZWFkZXJfYmxvY2tfbWIpO1xuICAgICAgICBpZiAoISh3aW5vd1dpZHRoID4gMTAyMyAmJiB3aW5vd1dpZHRoIDwgMTM0NykpIHtcbiAgICAgICAgICAgIHRhYmxlSGVpZ3RoID0gdGFibGVIZWlndGggLSBwYXJzZUludChjb250YWluZXJfcHQpIC0gcGFyc2VJbnQoY29udGFpbmVyX3BiKSArIHBhcnNlSW50KGhlYWRlcl9ibG9ja19tYik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGFibGVfd3JhcHBlci5zdHlsZS5oZWlnaHQgPSBgJHt0YWJsZUhlaWd0aH1weGA7XG4vL3RhYmxlX2NvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSB0YWJsZV93cmFwcGVyLnN0eWxlLmhlaWdodDtcbiAgICB0YWJsZV9jb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gYCR7dGFibGVIZWlndGh9cHhgO1xuICAgIHRhYmxlX3dyYXBwZXIuc3R5bGUubWF4SGVpZ2h0ID0gYCR7dGFibGVIZWlndGh9cHhgO1xuXG5cbn0pKCk7IiwiOyhmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZGlhbG9nVGVtcGxFbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsLXRlbXBsYXRlJyk7XG4gICAgaWYgKCFkaWFsb2dUZW1wbEVsZW0pIHJldHVybjtcbiAgICBjb25zdCBtb2RhbFRlbXBsYXRlID0gZGlhbG9nVGVtcGxFbGVtLmlubmVySFRNTDtcbiAgICBjb25zdCByZXNlYXJjaFRlbXBsYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc2VhcmNoVGFibGUnKS5pbm5lckhUTUw7XG4gICAgY29uc3QgbWVkaWNpbmVzVGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVkaWNpbmVzVGFibGUnKS5pbm5lckhUTUw7XG4gICAgbGV0IGN1cnJlbnRUYWJsZU5hbWUgPSAnbnVyc2VfdGFibGUnO1xuXG4gICAgY29uc3Qgb3BlbkRpYWxvZ0J1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubnVyc2UtbWFpbiAuYnRuLS10YWJsZScpO1xuICAgIG9wZW5EaWFsb2dCdXR0b25zLmZvckVhY2goYnRuID0+IHtcbiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG4gICAgICAgICAgICBsZXQgdGVtcGxhdGUgPSByZXNlYXJjaFRlbXBsYXRlO1xuICAgICAgICAgICAgbGV0IGlkID0gJyNyZXNlYXJjaF90YWJsZSc7XG5cbiAgICAgICAgICAgIGlmIChidG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdidG4tLXB1cnBsZScpKSB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGUgPSBtZWRpY2luZXNUZW1wbGF0ZTtcbiAgICAgICAgICAgICAgICBpZCA9ICcjbWVkaWNpbmVzX3RhYmxlJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xuICAgICAgICAgICAgdmFyIGRpYWxvZyA9IGNyZWF0ZURpYWxvZyh0ZW1wbGF0ZSk7XG4gICAgICAgICAgICBkaWFsb2cub3BlbigpO1xuICAgICAgICAgICAgY29uc3QgdGFibGVXcmFwcGVyID0gZGlhbG9nLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcudGFibGVfd3JhcHBlcicpO1xuXG4gICAgICAgICAgICBhY3RpdmF0ZVRhYmxlU2Nyb2xsKHRhYmxlV3JhcHBlciwgaWQpXG4gICAgICAgIH0pXG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVEaWFsb2coZGlhbG9nVGVtcGF0ZSkge1xuICAgICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGNvbnRhaW5lci5jbGFzc05hbWUgPSAncG9wdXAnO1xuICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gbW9kYWxUZW1wbGF0ZTtcbiAgICAgICAgdmFyIG92ZXJsYXkgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLm92ZXJsYXknKTtcbiAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdkaWFsb2ctLWZsZXgtZGlzcGxheScpO1xuICAgICAgICAvL2lmICh3aW5kb3cuaW5uZXJXaWR0aCA8PSA3NjgpIG92ZXJsYXkuY2xhc3NMaXN0LmFkZCgncGwzMCcpO1xuICAgICAgICB2YXIgcG9wdXBDb250YWluZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnBvcHVwX19jb250YWluZXInKTtcbiAgICAgICAgcG9wdXBDb250YWluZXIuaW5uZXJIVE1MID0gZGlhbG9nVGVtcGF0ZTtcblxuICAgICAgICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlLnRhcmdldCA9PT0gb3ZlcmxheSkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb250YWluZXI6IGNvbnRhaW5lcixcbiAgICAgICAgICAgIG9wZW46IGZ1bmN0aW9uIG9wZW4oKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNsb3NlOiBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGNvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGVUYWJsZVNjcm9sbCh0YWJsZVdyYXBwZXIsIGlkKSB7XG5cbiAgICAgICAgaWYgKHRhYmxlV3JhcHBlcikge1xuICAgICAgICAgICAgdmFyIGluc3RhbmNlMSA9IE92ZXJsYXlTY3JvbGxiYXJzKHRhYmxlV3JhcHBlciwge1xuICAgICAgICAgICAgICAgIHNjcm9sbGJhcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgYXV0b0hpZGU6ICdsZWF2ZScsXG4gICAgICAgICAgICAgICAgICAgIGF1dG9IaWRlRGVsYXk6IDUwMFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJChpZCkuZmxvYXRUaGVhZCh7XG4gICAgICAgICAgICAgICAgc2Nyb2xsQ29udGFpbmVyOiBmdW5jdGlvbigkdGFibGUpe1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkdGFibGUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHRhYmxlLmNsb3Nlc3QoJy50YWJsZS1yZXNwb25zaXZlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICQoJ3RhYmxlJykuZmxvYXRUaGVhZCgncmVmbG93Jyk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIjsoZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIGNvbnN0IGNsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRhdGV0aW1lJyk7XG4gICAgaWYgKGNsb2NrKSB7XG4gICAgICAgIHZhciBjYWxlbmRhciA9IG5ldyBDYWxlbmRhckNsb2NrKCcuZGF0ZXRpbWUnKTtcbiAgICAgICAgdmFyIGludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGVuZGFyLnVwZGF0ZSgpO1xuICAgICAgICB9LCAxMDAwKTtcbiAgICB9XG5cbiAgICBjb25zdCBsYXllcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubGF5ZXInKTtcblxuICAgIGxheWVycy5mb3JFYWNoKGxheWVyID0+IHtcbiAgICAgICAgbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFBhcmVudCA9IGUudGFyZ2V0LnBhcmVudE5vZGU7XG4gICAgICAgICAgICBpZiAoIXRhcmdldFBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2xheWVyX190b3AnKSAmJiAhdGFyZ2V0UGFyZW50LmNsYXNzTGlzdC5jb250YWlucygnbGF5ZXInKSApIHJldHVybjtcbiAgICAgICAgICAgIHNldEFjdGl2ZShsYXllcilcbiAgICAgICAgfSlcbiAgICB9KTtcblxuICAgIGNvbnN0IHNjaGVkdWxlX2xpc3RfX2l0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2NoZWR1bGUtbGlzdF9faXRlbScpO1xuXG4gICAgc2NoZWR1bGVfbGlzdF9faXRlbS5mb3JFYWNoKHNjaGVkdWxlX2xpc3RfX2l0ZW1faSA9PiB7XG4gICAgICAgIHNjaGVkdWxlX2xpc3RfX2l0ZW1faS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZS50YXJnZXQucGFyZW50Tm9kZSk7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRQYXJlbnQgPSBlLnRhcmdldC5wYXJlbnROb2RlO1xuICAgICAgICAgICAgLy9pZiAoIXRhcmdldFBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2xheWVyX190b3AnKSAmJiAhdGFyZ2V0UGFyZW50LmNsYXNzTGlzdC5jb250YWlucygnbGF5ZXInKSApIHJldHVybjtcbiAgICAgICAgICAgIHNldEFjdGl2ZShzY2hlZHVsZV9saXN0X19pdGVtX2kpXG4gICAgICAgIH0pXG4gICAgfSk7XG4gICAgZnVuY3Rpb24gc2V0QWN0aXZlKGl0ZW0pIHtcbiAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkge1xuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBwYXJlbnQgPSBpdGVtLnBhcmVudE5vZGU7XG4gICAgICAgIHZhciBhY3RpdmVJdGVtID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY3RpdmUnKTtcbiAgICAgICAgaWYgKGFjdGl2ZUl0ZW0pIGFjdGl2ZUl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgfVxuXG4gICAgLy8g0L/QvtC00LrQu9GO0YfQtdC90LjQtSDRgdC60YDQvtC70LvQsFxuICAgIC8vaW5pdGlhbGl6ZSBwbHVnaW4gd2l0aCBjdXN0b20gb3B0aW9ucyBvbiBhbGwgZGl2LnNjcm9sbGVkIGVsZW1lbnRzIGFuZCByZXR1cm4gYWxsIGluc3RhbmNlcyBhcyBhcnJheVxuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2Nyb2xsZWQnKS5sZW5ndGggPT09IDApIHJldHVybjtcbiAgICB2YXIgaW5zdGFuY2VzID0gT3ZlcmxheVNjcm9sbGJhcnMoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNjcm9sbGVkJyksIHtcbiAgICAgICAgc2Nyb2xsYmFyczoge1xuICAgICAgICAgICAgYXV0b0hpZGU6ICdzY3JvbGwnLFxuICAgICAgICAgICAgYXV0b0hpZGVEZWxheTogMTAwMFxuICAgICAgICB9XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuLy8gPT09PT09PSDQoNCw0LHQvtGC0LAg0YEg0L/QvtC00YHQutCw0LfQutCw0LzQuCAo0YHRgtGA0LDQvdC40YbQsCDQvNC10LTRgdC10YHRgtGA0YspXG4vL2FsZXJ0KCcxJyk7XG4gICAgdmFyIHBvcHVwVGVtbEVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcG9wdXAtdGVtcGxhdGUnKTtcbiAgICBpZiAoIXBvcHVwVGVtbEVsZW0pIHJldHVybjtcbiAgICB2YXIgUE9QVVBfVEVNUExBVEUgPSBwb3B1cFRlbWxFbGVtLmlubmVySFRNTDtcbiAgICB2YXIgcG9wdXBJbmRleCA9IDE7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIC8vaWYgKHdpbmRvdy5pbm5lcldpZHRoID4gNzY4KSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9yZXR1cm4gZmluZFBvcHVwKHBvcHVwSW5kZXgpO1xuICAgICAgICB9LCA1MDApO1xuICAgICAgICAvL31cbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZU1vZGFsKGVsZW0sIHBhcmVudEJsb2NrKSB7XG4gICAgICAgIGxldCB7eX0gPSB7Li4uZ2V0UG9zaXRpb24oZWxlbSl9O1xuICAgICAgICBzY3JvbGxUb0VsZW0oZWxlbSwgeSk7XG4gICAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY29udGFpbmVyLmNsYXNzTmFtZSA9ICdwb3B1cCc7XG4gICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBQT1BVUF9URU1QTEFURTtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSBlbGVtLmRhdGFzZXQucG9wdXBUZXh0O1xuICAgICAgICB2YXIgYW5jaG9yQ2xhc3MgPSBlbGVtLmRhdGFzZXQucG9wdXBQb3NpdGlvbjtcbiAgICAgICAgdmFyIGRpYWxXaW5kb3cgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmRpYWwtd2luZG93Jyk7XG4gICAgICAgIGRpYWxXaW5kb3cuY2xhc3NMaXN0LmFkZChhbmNob3JDbGFzcyk7XG4gICAgICAgIHZhciBwb3B1cFRleHQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmRpYWwtd2luZG93X190ZXh0Jyk7XG4gICAgICAgIHBvcHVwVGV4dC5pbm5lckhUTUwgPSBjb250ZW50O1xuICAgICAgICB2YXIgcG9wdXBDb250YWluZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnBvcHVwX19jb250YWluZXInKTtcbiAgICAgICAgcG9wdXBDb250YWluZXIuY2xhc3NMaXN0LmFkZCgncG9zX2FicycpO1xuXG4gICAgICAgIHZhciBidG4gPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignI3BvcHVwQ2xvc2UnKTtcbiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIC8vZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChjb250YWluZXIpO1xuICAgICAgICAgICAgcGFyZW50QmxvY2sucmVtb3ZlQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgICAgICAgIGVsZW0uY2xhc3NMaXN0LnJlbW92ZSgnaGlnaHRsaWdodCcpO1xuICAgICAgICAgICAgZmluZFBvcHVwKCsrcG9wdXBJbmRleCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY29udGFpbmVyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNob3dNb2RhbChlbGVtKSB7XG4gICAgICAgIC8vdmFyIHBhcmVudEJsb2NrID0gZWxlbS5jbG9zZXN0KCcucG9wdXAtd3JhcHBlcicpO1xuICAgICAgICB2YXIgcGFyZW50QmxvY2sgPSBnZXRDbG9zZXN0UGFyZW50KGVsZW0sICdwb3B1cC13cmFwcGVyJyk7XG4gICAgICAgIHZhciBtb2RhbCA9IGNyZWF0ZU1vZGFsKGVsZW0sIHBhcmVudEJsb2NrKTsgLy9kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTtcbiAgICAgICAgcGFyZW50QmxvY2suYXBwZW5kQ2hpbGQobW9kYWwpO1xuICAgICAgICAvL2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobW9kYWwpO1xuICAgICAgICB2YXIgY29udGVudEJsb2NrID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBvcHVwX19jb250YWluZXInKTtcbiAgICAgICAgbGV0IHt4LCB5fSA9IHsuLi5nZXRQb3NpdGlvbihlbGVtKX07XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB2YXIgY29vcmRzID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIHZhciBsZWZ0ID0geCA9PT0gJ2xlZnQnID8gY29vcmRzLmxlZnQgOiBjb29yZHMucmlnaHQgLSBjb250ZW50QmxvY2sub2Zmc2V0V2lkdGggLSAxMDtcbiAgICAgICAgICAgIHZhciB0b3AgPSB5ID09PSAndG9wJyA/IGNvb3Jkcy5ib3R0b20gKyAyNSA6IGNvb3Jkcy50b3AgLSBjb250ZW50QmxvY2sub2Zmc2V0SGVpZ2h0IC0gNTA7XG5cbiAgICAgICAgICAgIGlmIChlbGVtLmNsYXNzTGlzdC5jb250YWlucygndGFibGVfd3JhcHBlcicpKSB7XG4gICAgICAgICAgICAgICAgbGVmdCA9IGNvb3Jkcy5sZWZ0IC0gY29udGVudEJsb2NrLm9mZnNldFdpZHRoIC8gMjtcbiAgICAgICAgICAgICAgICB0b3AgPSB0b3AgKyAyMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbGVtLmNsYXNzTGlzdC5jb250YWlucygncmVtaW5kZXItaXRlbS13cmFwJykpIHtcbiAgICAgICAgICAgICAgICBsZWZ0ID0gbGVmdCAtIDIwO1xuICAgICAgICAgICAgICAgIHRvcCA9IHdpbmRvdy5pbm5lckhlaWdodCA8IDc2OCA/IHRvcCAtIDIwMCA6IHRvcCAtIDE1MDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGVsZW0udGFnTmFtZSA9PT0gJ1REJykge1xuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSAxMzQ4KSB7XG4gICAgICAgICAgICAgICAgICAgIGxlZnQgPSBsZWZ0ICsgMjA7XG4gICAgICAgICAgICAgICAgICAgIC8vdG9wID0gZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoJ3Jlc2VhcmNoLXBvcHVwJykgPyB0b3AgOiB0b3AgKyA1O1xuICAgICAgICAgICAgICAgICAgICB0b3AgPSB0b3AgKyAyNVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod2luZG93LmlubmVyV2lkdGggPiAxMDIzKSB7XG4gICAgICAgICAgICAgICAgICAgIGxlZnQgPSBlbGVtLmNsYXNzTGlzdC5jb250YWlucygncmVzZWFyY2gtcG9wdXAnKSA/IGxlZnQgOiBsZWZ0ICsgMjA7XG4gICAgICAgICAgICAgICAgICAgIHRvcCA9IHRvcCArIDMwO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod2luZG93LmlubmVyV2lkdGggPiA0MjUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGVmdCA9IGxlZnQgKyAyMDtcbiAgICAgICAgICAgICAgICAgICAgdG9wID0gdG9wICsgMzA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+IDM3NCkge1xuICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gbGVmdCArIDkwO1xuICAgICAgICAgICAgICAgICAgICB0b3AgPSB0b3AgKyAzMDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gMTU7XG4gICAgICAgICAgICAgICAgICAgIHRvcCA9IHRvcCArIDMwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCh0b3AgKyBjb250ZW50QmxvY2sub2Zmc2V0SGVpZ2h0KSA+IHdpbmRvdy5pbm5lckhlaWdodCkge1xuICAgICAgICAgICAgICAgIHRvcCA9IGNvb3Jkcy50b3AgLSBjb250ZW50QmxvY2sub2Zmc2V0SGVpZ2h0IC0gNTA7XG4gICAgICAgICAgICAgICAgdmFyIGFuY2hvckVsZW0gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGlhbC13aW5kb3cnKTtcbiAgICAgICAgICAgICAgICB2YXIgYW5jaG9yQ2xhc3MgPSBlbGVtLmRhdGFzZXQucG9wdXBQb3NpdGlvbjtcbiAgICAgICAgICAgICAgICBhbmNob3JFbGVtLmNsYXNzTGlzdC5yZW1vdmUoYW5jaG9yQ2xhc3MpO1xuICAgICAgICAgICAgICAgIGFuY2hvckNsYXNzID0gYW5jaG9yQ2xhc3MucmVwbGFjZSgndG9wJywgJ2JvdHRvbScpO1xuICAgICAgICAgICAgICAgIGFuY2hvckVsZW0uY2xhc3NMaXN0LmFkZChhbmNob3JDbGFzcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICgoZWxlbS50YWdOYW1lICE9PSAnVEQnICYmICFlbGVtLmNsYXNzTGlzdC5jb250YWlucygncmVtaW5kZXItaXRlbS13cmFwJykpICYmIHdpbmRvdy5pbm5lckhlaWdodCA+IDYwMCkge1xuICAgICAgICAgICAgICAgIGVsZW0uY2xhc3NMaXN0LmFkZCgnaGlnaHRsaWdodCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZWZ0ID0gbGVmdCA8IDAgPyAwIDogbGVmdDtcbiAgICAgICAgICAgIHRvcCA9IHRvcCA8IDAgPyAwIDogdG9wO1xuXG4gICAgICAgICAgICBjb250ZW50QmxvY2suc3R5bGUubGVmdCA9IGxlZnQgKyBcInB4XCI7XG4gICAgICAgICAgICBjb250ZW50QmxvY2suc3R5bGUudG9wID0gdG9wICsgXCJweFwiO1xuXG4gICAgICAgICAgICBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm92ZXJsYXknKTtcbiAgICAgICAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAgICAgICAgICAgLy9jb250ZW50QmxvY2suY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xuICAgICAgICB9LCAxMDApO1xuXG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaW5kUG9wdXAoaW5kZXgpIHtcbiAgICAgICAgdmFyIHNlbGVjdG9yID0gXCJbZGF0YS1wb3B1cC1pbmRleD1cXFwiXCIgKyBpbmRleCArIFwiXFxcIl1cIjtcbiAgICAgICAgdmFyIGVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcblxuICAgICAgICBpZiAoZWxlbSkge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2hvd01vZGFsKGVsZW0pO1xuICAgICAgICAgICAgfSwgMClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjcm9sbFRvRWxlbShlbGVtLCBhbmNob3JQb3NpdGlvbikge1xuICAgICAgICB2YXIgaXNUb3AgPSBhbmNob3JQb3NpdGlvbiA9PT0gJ3RvcCcgJiYgcG9wdXBJbmRleCAhPT0gMTtcbiAgICAgICAgZWxlbS5zY3JvbGxJbnRvVmlldyhpc1RvcCk7XG4gICAgICAgIHZhciBzY3JvbGxWYWxsID0gcG9wdXBJbmRleCA9PSAxID8gMCA6IGlzVG9wID8gLTMwIDogMzA7IC8vINC80LDQs9C40YfQtdGB0LrQuNC1INGG0LjRhNGA0YssIC0g0L/RgNC+0YHRgtC+INC80L3QtSDRgtCw0Log0LfQsNGF0L7RgtC10LvQvtGB0YxcbiAgICAgICAgd2luZG93LnNjcm9sbEJ5KDAsIHNjcm9sbFZhbGwpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0UG9zaXRpb24oZWxlbSkge1xuICAgICAgICB2YXIgcG9zaXRpb24gPSBlbGVtLmRhdGFzZXQucG9wdXBQb3NpdGlvbjtcbiAgICAgICAgdmFyIHBvcyA9IHBvc2l0aW9uLnNwbGl0KCctJyk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IHBvc1sxXSxcbiAgICAgICAgICAgIHk6IHBvc1swXVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Q2xvc2VzdFBhcmVudChlbGVtLCBjbGFzc05hbWUpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTtcbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgd2hpbGUgKHBhcmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhwYXJlbnQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50Tm9kZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyJdfQ==
